{"version":3,"sources":["node_modules/browserify/node_modules/browser-pack/_prelude.js","src/scripts/animationInfo.js","src/scripts/animationrenderer.js","src/scripts/app.js","src/scripts/body.js","src/scripts/bodypart.js","src/scripts/grid.js","src/scripts/logger.js","src/scripts/proxydebugger.js","src/scripts/scheduler.js","src/scripts/stack.js","src/scripts/utils.js"],"names":[],"mappings":"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","file":"app.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","class AnimationInfo {\n\tconstructor(animationInfo, duration, parentPart) {\n\t\tthis.duration = duration;\n\t\tthis.rotation = animationInfo.rotation;\n\t\tthis.parentPart = parentPart;\n\t}\n\n\tgetInterpolatedLocalRotation(frameId) {\n\t\tif (frameId < 0) {\n\t\t\tthrow new Error(\"Negative frameId not allowed.\");\n\t\t}\n\n\t\tif (typeof this.rotation[frameId] !== 'undefined') {\n\t\t\treturn this.rotation[frameId];\n\t\t}\n\n\t\t// 1. Find the previous keyframe.\n\t\tlet previousId = frameId;\n\t\tlet previousKeyFrameValue = this.rotation[previousId];\n\t\twhile (typeof previousKeyFrameValue == 'undefined' && previousId > 0) {\n\t\t\tpreviousId--;\n\t\t\tpreviousKeyFrameValue = this.rotation[previousId];\n\t\t} \n\n\t\t// 2. Find the next keyframe.\n\t\tlet nextId = frameId + 1;\n\t\tlet nextKeyFrameValue = this.rotation[nextId];\n\t\twhile (typeof nextKeyFrameValue == 'undefined') {\n\t\t\tnextId++;\n\n\t\t\tif (nextId >= this.duration - 1) {\n\t\t\t\tnextId = 0;\n\t\t\t\tnextKeyFrameValue = this.rotation[nextId];\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tnextKeyFrameValue = this.rotation[nextId];\n\t\t} \n\n\t\t// 3. Return the interpolated value.\n\t\tlet ratio;\n\t\tif (nextId === 0) {\n\t\t\tratio = (frameId - previousId) / (this.duration - previousId);\n\t\t} else {\n\t\t\tratio = (frameId - previousId) / (nextId - previousId);\n\t\t}\n\t\treturn previousKeyFrameValue + ratio * (nextKeyFrameValue - previousKeyFrameValue);\n\t}\n}\n\nmodule.exports = AnimationInfo;","class AnimationRenderer {\n\tconstructor(duration, doLoop, renderFn) {\n\t\tthis.duration_ = duration;\n\t\tthis.doLoop_ = doLoop;\n\t\tthis.renderFn_ = renderFn;\n\n\t\tthis.frameId_ = 0;\n\t}\n\n\tnextFrame() {\n\t\tthis.renderFn_(this.frameId_);\n\n\t\tif (this.frameId_ < this.duration_ - 1) {\n\t\t\tthis.frameId_ += 1;\n\t\t} else if (this.doLoop_) {\n\t\t\tthis.frameId_ = 0;\n\t\t}\n\t}\n\n\tsetFrameId(frameId) {\n\t\tthis.frameId_ = frameId;\n\t}\n\n\tsetLoop(doLoop) {\n\t\tthis.doLoop_ = doLoop;\n\t}\n}\nmodule.exports = AnimationRenderer;","let AnimationRenderer = require('./animationrenderer');\nlet Body = require('./body');\nlet Grid = require('./grid');\nlet Logger = require('./logger');\nlet ProxyDebugger = require('./proxydebugger');\nlet Scheduler = require('./scheduler');\nlet Utils = require('./utils');\n\nlet global = Utils.getGlobalObject();\n\nlet logger = new Logger(global);\nlogger.enabled = false;\n\n// Set to true to see all canvas calls.\nlet instrumentContext = false;\n\n// Prepare grid.\nGrid.drawGrid(document.getElementById('grid').getContext('2d'), logger);\n\nlet elements = {\n\tplayBtn: document.getElementById('play-button'),\n\tstopBtn: document.getElementById('stop-button'),\n\tframeSlider: document.getElementById('frame-id'),\n\tfps: document.getElementById('fps'),\n\tloop: document.getElementById('loop'),\n}\n\n// Possibly instrument the main context oject.\nlet ctx = document.getElementById('manikin').getContext('2d');\nif (instrumentContext) {\n\tctx = ProxyDebugger.instrumentContext(ctx, 'ctx', logger, {\n\t\t'rotate': (argsIn) => {\n\t\t\t// Print angles in degrees.\n\t\t\treturn [argsIn[0] * 180 / Math.PI]\n\t\t}\n\t});\n}\n\n// Build the body object.\nlet body = new Body('default', 'default', [100, 97], logger, () => {\n\tlet frameRenderFn = (frameId) => {\n\t\tctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n\t\tbody.renderFrame(frameId, ctx);\n\t\telements.frameSlider.value = frameId;\n\t};\n\n\tlet duration = body.getAnimationDuration();\n\telements.frameSlider.max = duration - 1;\n\tlet animationRenderer = new AnimationRenderer(duration,\n\t\telements.loop.checked, frameRenderFn);\n\n\tlet schedulerLogger = new Logger(global);\n\tschedulerLogger.enabled = false;\n\tlet scheduler = new Scheduler(\n\t\t[animationRenderer.nextFrame.bind(animationRenderer)],\n\t\tschedulerLogger, elements.fps.value);\n\n\telements.playBtn.addEventListener('click', () => {\n\t\telements.playBtn.classList.toggle('hidden');\n\t\telements.stopBtn.classList.toggle('hidden');\n\t\tscheduler.run();\n\t});\n\telements.stopBtn.addEventListener('click', () => {\n\t\telements.playBtn.classList.toggle('hidden');\n\t\telements.stopBtn.classList.toggle('hidden');\n\t\tscheduler.stop();\n\t});\n\telements.frameSlider.addEventListener('input', (e) => {\n\t\tscheduler.stop();\n\t\tframeRenderFn(e.currentTarget.value);\n\t\tanimationRenderer.setFrameId(e.currentTarget.value);\n\t});\n\telements.fps.addEventListener('focus', (e) => {\n\t\te.currentTarget.setSelectionRange(0, e.currentTarget.value.length);\n\t});\n\telements.fps.addEventListener('keyup', (e) => {\n\t\tlet val = parseInt(e.currentTarget.value, 10);\n\t\tif (val > 0 && val <= 60) {\n\t\t\tscheduler.setFps(val);\n\t\t}\n\t});\n\telements.loop.addEventListener('click', (e) => {\n\t\tanimationRenderer.setLoop(e.currentTarget.checked);\n\t});\n});\n","let BodyPart = require('./bodypart');\nlet Stack = require('./stack');\n\nconst ANIMATIONS_PATH = './animations';\nconst BODIES_PATH = './bodies';\n\nclass Body {\n\tconstructor(bodyConfigFilename, animationConfigFilename, absolutePosition, logger, afterReady) {\n\n\t\tthis.absolutePosition = absolutePosition;\n\t\tthis.logger = logger;\n\n\t\tthis.root = null;\n\t\tthis.duration = null;\n\t\tthis.looping = null;\n\n\t\tlet promises = [];\n\t\tpromises.push(this.jsonLoadPromiseFactory(\n\t\t\t`${BODIES_PATH}/${bodyConfigFilename}.json`, this.setBodyConfig));\n\t\tpromises.push(this.jsonLoadPromiseFactory(\n\t\t\t`${ANIMATIONS_PATH}/${animationConfigFilename}.json`, this.setAnimationConfig));\n\n\t\tPromise.all(promises).then(this.onReady.bind(this)).then(afterReady);\n\t}\n\n\tonReady() {\n\t\tthis.createParts();\n\t\tthis.loadAnimation();\n\t\tthis.calculateFrames();\t\t\n\t}\n\n\tsetBodyConfig(bodyConfig) {\n\t\tthis.bodyConfig = bodyConfig;\n\t\tthis.name = this.bodyConfig.name;\n\t}\n\n\tsetAnimationConfig(animationConfig) {\n\t\tthis.animationConfig = animationConfig;\n\t}\n\n\tjsonLoadPromiseFactory(relativePath, onSuccess) {\n\t\tlet p = new Promise((resolve, reject) => {\n\t\t\tlet req = new XMLHttpRequest();\n    \t\treq.open('GET', relativePath);\n\t\t\treq.onload = () => {\n\t\t\t\tif (req.status == 200) {\n\t\t\t\t\tonSuccess.bind(this)(JSON.parse(req.response));\n\t\t\t\t\tresolve();\n\t\t\t\t} else {\n\t\t\t\t\treject(Error(req.statusText));\n\t\t\t\t}\n\t\t\t}.bind(this);\n\t\t\treq.onerror = () => {\n\t\t\t\treject();\n\t\t\t}.bind(this);\n\t\t\treq.send();\n\t\t}.bind(this));\n\t\treturn p;\n\t}\n\n\tcreateParts() {\n\t\tlet parts = {};\n\t\t// Step 1: build all parts.\n\t\tfor (let partName in this.bodyConfig.parts) {\n\t\t\tlet isRoot = partName == 'root';\n\t\t\tlet partConfig = this.bodyConfig.parts[partName];\n\t\t\tparts[partName] = new BodyPart(\n\t\t\t\tpartName,\n\t\t\t\tisRoot,\n\t\t\t\tpartConfig.relativePosition,\n\t\t\t\tpartConfig.centerOffset,\n\t\t\t\tpartConfig.sprite,\n\t\t\t\tpartConfig.layer,\n\t\t\t\tthis.logger);\n\n\t\t\tif (isRoot) {\n\t\t\t\tthis.root = parts[partName];\n\t\t\t}\n\t\t}\n\n\t\t// Step 2: setup parent-child relationships.\n\t\tfor (let partName in parts) {\n\t\t\tif (partName == 'root') {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tlet partConfig = this.bodyConfig.parts[partName];\n\t\t\tlet childPart = parts[partName];\n\t\t\tlet parentPart = parts[partConfig.parentName];\n\n\t\t\tif (!parentPart) {\n\t\t\t\tthrow new Error(`Cannot find parent element by name ${partConfig.parentName} for child ${partName}`);\n\t\t\t}\n\n\t\t\tparentPart.addChild(childPart);\n\t\t}\n\t}\n\n\tforEachPart(fn, beforeLoopOverChildrenFn, afterLoopOverChildrenFn) {\n\t\tvar explored = [];\n\t\tlet storage = new Stack();\n\t\tstorage.flush();\n\t\tstorage.push(this.root);\n\t\tfn(this.root, this.root.getName());\n\t\tvar currentPart;\n\n\t\twhile((currentPart = storage.pop()) !== undefined) {\n\t\t\tif (beforeLoopOverChildrenFn) {\n\t\t\t\tbeforeLoopOverChildrenFn(currentPart);\n\t\t\t}\n\n\t\t\tlet currentName = currentPart.getName();\n\t\t\tlet children = currentPart.getChildren();\n\n\n\t\t\tfor(let name in children) {\n\t\t\t\tlet child = children[name];\n\t\t\t\tif (!explored[name]) {\n\t\t\t\t\texplored[name] = true;\n\t\t\t\t\tfn(child, name);\n\t\t\t\t\tstorage.push(child);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (afterLoopOverChildrenFn) {\n\t\t\t\tafterLoopOverChildrenFn(currentPart);\n\t\t\t}\n\t\t}\n\t\tstorage.flush();\n\t}\n\n\tloadAnimation() {\n\t\tlet animObject = this.animationConfig;\n\t\tthis.duration = animObject.duration;\n\t\tthis.looping = animObject.looping;\n\n\t\tthis.forEachPart((part, name) => {\n\t\t\tif (!animObject.frames[name]) {\n\t\t\t\t//throw new Error(`No frame info for body part ${name} in animation object:`, animObject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpart.loadAnimationInfo(this.duration, animObject.frames[name]);\n\t\t});\n\t}\n\n\tgetAnimationDuration() {\n\t\treturn this.duration;\n\t}\n\n\tcalculateFrames() {\n\t\tthis.forEachPart((part) => {\n\t\t\tpart.calculateFrames();\n\t\t});\n\t}\n\n\tgetCalculatedFrames() {\n\t\tlet calculatedFrames = {};\n\t\tthis.forEachPart((part, name) => {\n\t\t\tcalculatedFrames[name] = part.getCalculatedFrames();\n\t\t});\n\t\treturn calculatedFrames;\n\t}\n\n\trenderFrame(frameId, ctx) {\n\t\tctx = this.instrumentContext(ctx);\n\t}\n\n\trenderFrame(frameId, ctx) {\n\t\tctx.save();\n\t\tctx.translate(this.absolutePosition[0], this.absolutePosition[1]);\n\n\t\t// Build a list of parts, ordered by layer.\n\t\tlet parts = []\n\t\tthis.forEachPart((part, name) => {\n\t\t\tparts.push(part);\n\t\t});\n\n\t\tparts.sort((a, b) => {\n\t\t\treturn a.layer - b.layer;\n\t\t});\n\n\t\tparts.forEach((part) => {\n\t\t\tlet name = part.getName();\n\t\t\tthis.logger.groupCollapsed(`rendering ${name}`);\n\t\t\tctx.save();\n\t\t\tpart.positionContextForFrame(frameId, ctx);\n\t\t\tpart.drawSpriteForFrame(frameId, ctx);\n\t\t\tctx.restore();\n\t\t\tthis.logger.groupEnd();\n\n\t\t});\n\t\t\n\t\tctx.restore();\n\t}\n}\n\nmodule.exports = Body;","let AnimationInfo = require('./animationInfo');\n\nclass BodyPart {\n\tconstructor(name, isRoot, relativePosition, centerOffset, sprite, layer, logger) {\n\t\tthis.name = name;\n\n\t\t// Vector going from parent to this part.\n\t\tthis.relativePosition = relativePosition;\n\n\t\t// Offset to allow parts to rotate around the joints.\n\t\tthis.centerOffset = centerOffset;\n\n\t\tthis.layer = layer;\n\n\t\tif (typeof sprite === \"string\") {\n\t\t\t// Individual sprite\n\t\t\tlet img = document.createElement('img');\n\t\t\timg.src = sprite;\n\t\t\timg.addEventListener('load', (e) => {\n\t\t\t\tthis.logger.log('image loaded', e);\n\t\t\t})\n\t\t\tdocument.getElementById('images').appendChild(img);\n\t\t\tthis.sprite = img;\t\t\n\t\t} else {\n\t\t\t// Store dimensions, we'll refer to root for the image.\n\t\t\tthis.sprite = sprite;\n\t\t}\n\n\t\tthis.logger = logger;\n\n\t\tthis.parent = null;\n\t\tthis.isRoot = isRoot;\n\t\tthis.root = null;\n\t\tthis.children = {};\n\t\t\n\t\tthis.animationInfo = null;\n\t\tthis.calculatedFrames = {};\n\t\tthis.duration = 0;\n\t}\n\n\tsetParent(parent) {\n\t\tthis.parent = parent;\n\t\tthis.root = parent.getRoot();\n\t}\n\n\tgetParent() {\n\t\treturn this.parent;\n\t}\n\n\tgetRoot() {\n\t\tif (this.isRoot) {\n\t\t\treturn this;\n\t\t}\n\t\treturn this.root;\n\t}\n\n\tgetName() {\n\t\treturn this.name;\n\t}\n\n\tgetChildren() {\n\t\treturn this.children;\n\t}\n\n\tgetChildByName(name) {\n\t\treturn this.children[name];\n\t}\n\n\taddChild(child) {\t\t\n\t\tlet childName = child.getName();\n\t\tchild.setParent(this);\n\t\tif (this.children[childName]) {\n\t\t\tlet existing = this.children[childName];\n\t\t\tlet parentChain = existing.getParentChainAsString()\n\t\t\tthrow new Error(`Cannot add child: '${this.name}' already has a child by the name of '${childName}': ${parentChain}`);\n\t\t}\n\t\tthis.children[childName] = child;\n\t}\n\n\tgetParentChain() {\n\t\tlet chain = [];\n\t\tlet currentPart = this;\n\t\twhile (currentPart = currentPart.getParent()) {\n\t\t\tchain.unshift(currentPart);\n\t\t}\n\n\t\treturn chain;\n\t}\n\n\tgetParentChainAsString() {\n\t\tlet stringParts = [];\n\t\tlet currentPart = this;\n\t\tdo {\n\t\t\tstringParts.unshift(currentPart.getName());\n\t\t} while (currentPart = currentPart.getParent());\n\n\t\treturn stringParts.join(' -> ');\n\t}\n\n\tgetAnimationInfo() {\n\t\treturn this.animationInfo;\n\t}\n\n\tloadAnimationInfo(duration, animationInfo) {\n\t\tthis.duration = duration;\n\t\tthis.animationInfo = new AnimationInfo(animationInfo, duration, this);\n\t}\n\n\tgetCalculatedFrame(frameId) {\n\t\tif (frameId >= this.duration) {\n\t\t\tthrow new Error(`Requested frameId (${frameId}) too high. Duration is ${this.duration}.`)\n\t\t}\n\t\treturn this.calculatedFrames[frameId];\n\t}\n\n\tcalculateFrames() {\n\t\tfor(let f = 0; f < this.duration; f++) {\n\n\t\t\tlet localRotation = this.animationInfo.getInterpolatedLocalRotation(f);\n\t\t\tlet relativePosition = this.relativePosition;\n\n\t\t\tthis.calculatedFrames[f] = {\n\t\t\t\t'position': relativePosition,\n\t\t\t\t'rotation': localRotation\n\t\t\t};\n\t\t}\n\t}\n\n\tgetDrawInfoForFrame(frameId) {\n\t\tif (frameId >= this.duration) {\n\t\t\tthrow new Error(`Requested frameId (${frameId}) too high. Duration is ${this.duration}.`)\n\t\t}\n\t\treturn {\n\t\t\t'position': this.calculatedFrames.position[frameId],\n\t\t\t'rotation': this.calculatedFrames.rotation[frameId]\n\t\t}\n\t}\n\n\t/*\n\t * Starts from the root element, and positions the context\n\t * so that (0, 0) coincides with the origin of the current part.\n\t */\n\tpositionContextForFrame(frameId, ctx) {\n\t\tlet parentParts = this.getParentChain();\n\t\tparentParts.forEach((parentPart) => {\n\t\t\tthis.logger.groupCollapsed(`positioning canvas according to ${parentPart.getName()}`);\n\t\t\tlet frameInfo = parentPart.getCalculatedFrame(frameId);\n\t\t\tctx.translate(parentPart.relativePosition[0], parentPart.relativePosition[1]);\n\t\t\tctx.translate(parentPart.centerOffset[0], parentPart.centerOffset[1]);\n\t\t\tctx.rotate((Math.PI / 180) * frameInfo.rotation);\n\t\t\tctx.translate(- parentPart.centerOffset[0], - parentPart.centerOffset[1]);\n\t\t\tthis.logger.groupEnd();\n\t\t});\n\t}\n\n\t/*\n\t * Draws the sprite for this part relative to the current\n\t * context origin.\n\t */\n\tdrawSpriteForFrame(frameId, ctx) {\n\t\tif (!this.sprite) {\n\t\t\treturn;\n\t\t}\n\t\tlet frameInfo = this.getCalculatedFrame(frameId);\n\t\tctx.translate(this.relativePosition[0], this.relativePosition[1]);\n\t\tctx.translate(this.centerOffset[0], this.centerOffset[1]);\n\t\tctx.rotate((Math.PI / 180) * frameInfo.rotation);\n\t\tctx.translate(- this.centerOffset[0], - this.centerOffset[1]);\n\t\tif (typeof this.sprite === \"string\") {\n\t\t\tctx.drawImage(this.sprite, 0, 0);\n\t\t} else {\n\t\t\tlet sprite = this.getRoot().sprite;\n\t\t\tctx.drawImage(sprite, this.sprite[0], this.sprite[1], this.sprite[2], this.sprite[3], 0, 0, this.sprite[2], this.sprite[3]);\n\t\t}\n\t}\n}\nmodule.exports = BodyPart;","let Grid = {\n\tdrawGrid: function(ctx, logger) {\n\t\tctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n\t\tlogger.groupCollapsed('Drawing grid');\n\t\tfor (let i = 0; i <= 200; i += 10) {\n\t\t\tlet strokeStyle = '#000000';\n\t\t\tif (i == 100) {\n\t\t\t\tstrokeStyle = '#ff0000';\n\t\t\t}\n\t\t\tctx.strokeStyle = strokeStyle;\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(0, i);\n\t\t\tctx.lineTo(200,i);\n\t\t\tctx.stroke();\n\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(i, 0);\n\t\t\tctx.lineTo(i, 200);\n\t\t\tctx.stroke();\n\t\t}\n\t\tlogger.groupEnd('Drawing grid');\n\t},\n};\n\nmodule.exports = Grid;","let Logger = function(global) {\n\tthis.enabled = true;\n\n\tthis._logger = global.console || {\n\t\tlog: function() {},\n\t\tgroup: function() {},\n\t\tgroupCollapsed: function() {},\n\t\tgroupEnd: function() {},\n\t};\n};\nLogger.prototype.log = function() {\n\tif (this.enabled) {\n\t\tthis._logger.log.apply(console, arguments);\n\t}\n}\nLogger.prototype.group = function() {\n\tif (this.enabled) {\n\t\tthis._logger.group.apply(console, arguments);\n\t}\n}\nLogger.prototype.groupCollapsed = function() {\n\tif (this.enabled) {\n\t\tthis._logger.groupCollapsed.apply(console, arguments);\n\t}\n}\nLogger.prototype.groupEnd = function() {\n\tif (this.enabled) {\n\t\tthis._logger.groupEnd.apply(console, arguments);\n\t}\n}\n\nmodule.exports = Logger;","let ProxyDebugger = {\n\tinstrumentContext: (original, logName, logger, modifiers) => {\n\t\t// The object that all calls will go through\n\t\tlet proxyObj = {};\n\n\t\tfor (let propName in original) {\n\t\t\tif (original[propName] instanceof Function) {\n\t\t\t\t// Proxying methods.\n\t\t\t\tproxyObj[propName] = (...args) => {\n\t\t\t\t\tlet argsForLogging = args;\n\t\t\t\t\tif (propName in modifiers) {\n\t\t\t\t\t\targsForLogging = modifiers[propName](args);\n\t\t\t\t\t}\n\t\t\t\t\tlogger.log(`${logName}.${propName}`, argsForLogging);  \n\t\t\t\t\toriginal[propName].apply(original, args);\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\t// Setters and getters for proxy'ed properties.\n\t\t\t\tObject.defineProperty(proxyObj, propName, {\n\t\t\t\t\tset: function(value) {\n\t\t\t\t\t \toriginal[propName] = value;\n\t\t\t\t\t\tlogger.log(`${logName}.${propName} = ${value}`);\n\t\t\t\t\t},\n\t\t\t\t\tget: function(name)\t{\n\t\t\t\t\t\treturn original[propName];\n\t\t\t\t\t}\n\t\t\t\t});    \n\t\t\t}\n\t\t}\n\t\treturn proxyObj;\n\t}\n}\n\nmodule.exports = ProxyDebugger;","const DEFAULT_FPS = 30;\n\nconst STOPPED = 'stopped';\nconst RUNNING = 'running';\n\nclass Scheduler {\n\tconstructor(renderCallbacks, logger, fps) {\n\t\tthis.renderCallbacks = renderCallbacks;\t\t\n\t\tthis.logger = logger;\n\n\t\tthis.setFps(fps || DEFAULT_FPS);\n\n\t\tthis.stop();\n\t}\n\n\tsetState(state) {\n\t\tthis.state = state;\n\t\tthis.logger.log(`Scheduler - setting state ${state}`);\n\t}\n\n\trun() {\n\t\tthis.setState(RUNNING);\n\t\tthis.raf_ = requestAnimationFrame(this.step_.bind(this));\n\t}\n\n\tstop() {\n\t\tif (this.state == STOPPED) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.lastTimestamp_ = 0;\n\t\tthis.setState(STOPPED);\n\n\t\tif (this.raf_) {\n\t\t\tcancelAnimationFrame(this.raf_);\t\t\t\n\t\t}\n\t\tthis.raf_ = null;\n\t}\n\n\tstep() {\n\t\tthis.raf_ = requestAnimationFrame(this.step_.bind(this));\n\t}\n\n\tstep_(timestamp) {\n  \t\tlet progress = timestamp - this.lastTimestamp_;\n\t\tthis.logger.log(`Scheduler - step_ - timestamp: ${timestamp} - lastTimestamp_: ${this.lastTimestamp_} - progress: ${progress}`);\n\t\tif (progress >= this.frameDuration_) {\n\t\t\tthis.renderCallbacks.forEach((cb) => {\n\t\t\t\tcb(timestamp);\n\t\t\t})\n\t\t\tthis.lastTimestamp_ = timestamp;\n\t\t}\n\t\tif (this.state == RUNNING) {\n\t\t\tthis.logger.log(`Scheduler - scheduling next step_`);\n\t\t\tthis.raf_ = requestAnimationFrame(this.step_.bind(this));\n\t\t}\n\t}\n\n\tsetFps(fps) {\n\t\tthis.fps_ = fps;\n\t\tthis.frameDuration_ = 1 / fps * 1000;\n\t}\n};\nmodule.exports = Scheduler;","class Stack {\n\tconstructor(onpop, onpush) {\n\t\tthis.arr = [];\n\t\tthis.onpop = onpop;\n\t\tthis.onpush = onpush;\t\t\n\t}\n\n\tpush(node) {\n\t\tthis.arr.push(node);\n\t\tif (this.onpush) {\n\t\t\tthis.onpush(node);\n\t\t}\n\t}\n\n\tpop() {\n\t\tvar node = this.arr.pop();\n\t\tif (this.onpop) {\n\t\t\tthis.onpop(node);\n\t\t}\n\t\treturn node;\n\t}\n\n\tflush() {\n\t\tthis.arr.length = 0;\n\t}\n}\nmodule.exports = Stack;","let Utils = {\n\t// From https://gist.github.com/rauschma/1bff02da66472f555c75\n\tgetGlobalObject: function() {\n\t    // Workers don’t have `window`, only `self`\n\t    if (typeof self !== 'undefined') {\n\t        return self;\n\t    }\n\t    if (typeof global !== 'undefined') {\n\t        return global;\n\t    }\n\t    // Not all environments allow eval and Function\n\t    // Use only as a last resort:\n\t    return new Function('return this')();\n\t}\n};\nmodule.exports = Utils;"]}